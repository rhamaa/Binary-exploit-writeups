# My Binary exploit write-ups, resources and Field Guide

This is mostly a reference for myself in my pwning endeavours. This contains my own write-ups/exploits of different challenges and useful exploit dev resources that helped me along the way. Maybe someone else also finds this useful ¯\_(ツ)_/¯.

Note that this is a work in progress and will be updated continuously.

### Table of Contents
- My Write-ups
	+ [Protostar](https://exploit-exercises.com/protostar/)
		+ [Reversing and Exploiting Protostar Stack challenges](https://github.com/Bengman/Binary-exploit-writeups/tree/master/protostar/stack)
	+ [OverTheWire](http://overthewire.org/wargames/)
		+ [Narnia](https://github.com/Bengman/Binary-exploit-writeups/tree/master/OvertheWire/Narnia)
	+ [Vulnserver](https://github.com/Bengman/Binary-exploit-writeups/tree/master/vulnserver)
	+ [Brainpan](https://github.com/Bengman/Binary-exploit-writeups/tree/master/Brainpan)
- [Windows Exploit development](#windows_exploit_development)
	+ [Windows Stack overflows](#windows_stack_overflows)
	+ [Windows SEH overflows](#windows_seh_overflows)
	+ [Windows Heap overflows](#windows_heap_overflows)
	+ [Windows Egg Hunting](#windows_egg_hunting)
	+ [Windows Kernel based overflows](#kernel_based_Windows_overflows)
	+ [Windows Kernel Memory Corruption](#windows_kernel_memory_corruption)
	+ [Windows memory protections](#windows_memory_protections)
	+ [Windows Shellcoding](#windows_shellcoding)
- [Linux Exploit development](#linux_exploit_development)
	+ [Format Strings](#format_strings)
	+ [Ret2libc](#ret2libc)
- [Reverse Engineering](#reverse_engineering)
- [Fuzzing](#fuzzing)
- [Binary Exploitation Challenges](#binary_exploitation_challenges)


# Exploit Development Resources

## <a name="windows_exploit_development" />Windows Exploit Development:

### <a name="windows_stack_overflows" />Windows Stack Overflows
+ [Corelan – Exploit writing tutorial part 1 – Stack based overflows](https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/)
+ [Corelan Exploit writing tutorial part 2 – Writing simple buffer overflow exploits](https://www.corelan.be/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/)
+ [Fuzzysecurity – Part 1: Introduction to Exploit Development](http://www.fuzzysecurity.com/tutorials/expDev/1.html)
+ [Fuzzysecurity – Part 2: Saved Return Pointer Overflows](http://www.fuzzysecurity.com/tutorials/expDev/2.html)
+ [Infosec Institute – Part 1: Introduction](http://resources.infosecinstitute.com/stack-based-buffer-overflow-tutorial-part-1-introduction/)
+ [Infosec Institute – Part 2: Exploiting the stack overflow](http://resources.infosecinstitute.com/stack-based-buffer-overflow-tutorial-part-2-exploiting-the-stack-overflow/)
+ [Infosec Institute – Part 3: Adding shellcode](http://resources.infosecinstitute.com/stack-based-buffer-overflow-tutorial-part-3-%E2%80%94-adding-shellcode/)
+ [Security Sift – Part 1: Basics](http://www.securitysift.com/windows-exploit-development-part-1-basics/)
+ [Security Sift – Part 2: Intro Stack Overflow](http://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/)
+ [Security Sift – Part 3: Changing offsets and rebased modules](http://www.securitysift.com/windows-exploit-development-part-3-changing-offsets-and-rebased-modules/)
+ [Security Sift – Part 4: Locating shellcode jumps](http://www.securitysift.com/windows-exploit-development-part-4-locating-shellcode-jumps/)
+ [Offensive Security – Quickzip stack bof 0day](https://www.offensive-security.com/vulndev/quickzip-stack-bof-0day-a-box-of-chocolates/)
+ [Sploitfun – Classic Stack Based Buffer Overflow](https://sploitfun.wordpress.com/2015/05/08/classic-stack-based-buffer-overflow/)

### <a name="windows_seh_overflows" />Windows SEH overflows
+ [Corelan – Part 3: SEH](https://www.corelan.be/index.php/2009/07/25/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-3-seh/)
+ [Corelan – Part 3b: Just another example](https://www.corelan.be/index.php/2009/07/28/seh-based-exploit-writing-tutorial-continued-just-another-example-part-3b/)
+ [Fuzzysecurity – Part 3: Structured Exception Handler (SEH)](http://www.fuzzysecurity.com/tutorials/expDev/3.html)
+ [Infosec Institute – SEH Based Overflow Exploit Tutorial](http://resources.infosecinstitute.com/writing-seh-exploits/)
+ [Infosec Institute – Writing SEH Exploits](http://resources.infosecinstitute.com/writing-seh-exploits/)
+ [Security Sift – Part 6: SEH Exploits](http://www.securitysift.com/windows-exploit-development-part-6-seh-exploits/)

### <a name="windows_heap_overflows" />Windows heap overflows
+ [Fuzzysecurity – Part 8: Spraying the Heap](http://www.fuzzysecurity.com/tutorials/expDev/8.html)
+ [Fuzzysecurity – What’s Going On Here b33f?](http://www.fuzzysecurity.com/tutorials/mr_me/1.html)
+ [Fuzzysecurity – Heap Overflows For Humans 101](http://www.fuzzysecurity.com/tutorials/mr_me/2.html)
+ [Fuzzysecurity – Heap Overflows For Humans 102](http://www.fuzzysecurity.com/tutorials/mr_me/3.html)
+ [Fuzzysecurity – Heap Overflows For Humans 102.5](http://www.fuzzysecurity.com/tutorials/mr_me/4.html)
+ [Fuzzysecurity – Heap Overflows For Humans 103](http://www.fuzzysecurity.com/tutorials/mr_me/5.html)
+ [Fuzzysecurity – Heap Overflows For Humans 103.5](http://www.fuzzysecurity.com/tutorials/mr_me/6.html)
+ [Infosec Institute –](http://resources.infosecinstitute.com/heap-overflow-vulnerability-and-heap-internals-explained/)
+ [Heap Overflow: Vulnerability and Heap Internals Explained](http://resources.infosecinstitute.com/heap-overflow-vulnerability-and-heap-internals-explained/)

### <a name="windows_egg_hunting" />Windows Egg hunting
+ [Fuzzysecurity – Egg Hunters](http://www.fuzzysecurity.com/tutorials/expDev/4.html)
+ [Infosec Institute – Egghunter Exploitation Tutorial](http://resources.infosecinstitute.com/buffer-overflow-vulnserver/)
+ [Security Sift – Part 5: Locating shellcode egghunting](http://www.securitysift.com/windows-exploit-development-part-5-locating-shellcode-egghunting/)

### <a name="kernel_based_Windows_overflows" />Windows Kernel based overflows
+ [Whitehatters – Intro to Windows kernel exploitation 1/N: Kernel Debugging](https://foxglovesecurity.com/2016/03/15/fuzzing-workflows-a-fuzz-job-from-start-to-finish/)
+ [Whitehatters – Intro to Windows kernel exploitation 2/N: HackSys Extremely Vulnerable Driver](http://whitehatters.academy/intro-to-windows-kernel-exploitation-2-windows-drivers/)
+ [Whitehatters – Intro to Windows kernel exploitation 3/N: My first Driver exploit](http://whitehatters.academy/intro-to-windows-kernel-exploitation-3-my-first-driver-exploit/)
+ [Whitehatters – Intro to Windows kernel exploitation 3.5/N: A bit more of the HackSys Driver](https://www.whitehatters.academy/intro-to-windows-kernel-exploitation-more-of-the-hacksys-driver/)

### <a name="windows_kernel_memory_corruption" />Windows Kernel Memory Corruption
+ [Remote Windows Kernel Exploitation](https://cansecwest.com/core05/windowsremotekernel.pdf) - by Barnaby Jack [2005]
+ [windows kernel-mode payload fundamentals](http://uninformed.org/index.cgi?v=3&a=4&t=sumry) - by Skape [2006]
+ [exploiting 802.11 wireless driver vulnerabilities on windows](http://www.uninformed.org/?v=6&a=2&t=sumry) - by Johnny Cache, H D Moore, skape [2007]
+ [Kernel Pool Exploitation on Windows 7](https://media.blackhat.com/bh-dc-11/Mandt/BlackHat_DC_2011_Mandt_kernelpool-wp.pdf) - by Tarjei Mandt [2011]
+ [Windows Kernel-mode GS Cookies and 1 bit of entropy](vexillium.org/dl.php?/Windows_Kernel-mode_GS_Cookies_subverted.pdf) - [2011]
+ [Subtle information disclosure in WIN32K.SYS syscall return values](http://j00ru.vexillium.org/?p=762) - [2011]
+ [nt!NtMapUserPhysicalPages and Kernel Stack-Spraying Techniques](http://j00ru.vexillium.org/?p=769) - [2011]
+ [SMEP: What is it, and how to beat it on Windows](http://j00ru.vexillium.org/?p=783) - [2011]
+ [Kernel Attacks through User-Mode Callbacks](http://www.mista.nu/research/mandt-win32k-paper.pdf) - by Tarjei Mandt [2011]
+ [Windows Security Hardening Through Kernel Address Protection](http://j00ru.vexillium.org/blog/04_12_11/Windows_Kernel_Address_Protection.pdf) - by Mateusz "j00ru" Jurczyk [2011]
+ [Reversing Windows8: Interesting Features of Kernel Security](http://hitcon.org/2012/download/0720A5_360.MJ0011_Reversing%20Windows8-Interesting%20Features%20of%20Kernel%20Security.pdf) - by MJ0011 [2012]
+ [Smashing The Atom: Extraordinary String Based Attacks](mista.nu/research/smashing_the_atom.pdf) - by Tarjei Mandt [2012]
+ [Easy local Windows Kernel exploitation](http://media.blackhat.com/bh-us-12/Briefings/Cerrudo/BH_US_12_Cerrudo_Windows_Kernel_WP.pdf) - by Cesar Cerrudo [2012]
+ [Using a Patched Vulnerability to Bypass Windows 8 x64 Driver Signature Enforcement](www.powerofcommunity.net/poc2012/mj0011.pdf) - by MJ0011 [2012]
+ [MWR Labs Pwn2Own 2013 Write-up - Kernel Exploit](https://labs.mwrinfosecurity.com/blog/mwr-labs-pwn2own-2013-write-up-kernel-exploit/) - [2013]
+ [KASLR Bypass Mitigations in Windows 8.1](www.alex-ionescu.com/?p=82) - [2013]
+ [First Dip Into the Kernel Pool: MS10-058](http://doar-e.github.io/blog/2014/03/11/first-dip-into-the-kernel-pool-ms10-058/) - by Jeremy [2014]
+ [Windows 8 Kernel Memory Protections Bypass](https://labs.mwrinfosecurity.com/blog/windows-8-kernel-memory-protections-bypass/) - [2014]
+ [An Analysis of A Windows Kernel-Mode Vulnerability (CVE-2014-4113)](http://blog.trendmicro.com/trendlabs-security-intelligence/an-analysis-of-a-windows-kernel-mode-vulnerability-cve-2014-4113/) - by Weimin Wu [2014]
+ [Sheep Year Kernel Heap Fengshui: Spraying in the Big Kids’ Pool](http://www.alex-ionescu.com/?p=231) - [2014]
+ [Exploiting the win32k!xxxEnableWndSBArrows use-after-free (CVE 2015-0057) bug on both 32-bit and 64-bit](https://www.nccgroup.trust/globalassets/newsroom/uk/blog/documents/2015/07/exploiting-cve-2015.pdf) - by Aaron Adams [2015]
+ [Exploiting MS15-061 Microsoft Windows Kernel Use-After-Free (win32k!xxxSetClassLong)](https://www.nccgroup.trust/globalassets/our-research/uk/whitepapers/2015/08/2015-08-27_-_ncc_group_-_exploiting_ms15_061_uaf_-_release.pdf) - by Dominic Wang [2015]
+ [Exploiting CVE-2015-2426, and How I Ported it to a Recent Windows 8.1 64-bit](https://www.nccgroup.trust/globalassets/our-research/uk/whitepapers/2015/09/2015-08-28_-_ncc_group_-_exploiting_cve_2015_2426_-_release.pdf) - by Cedric Halbronn [2015]
+ [Abusing GDI for ring0 exploit primitives](https://www.coresecurity.com/blog/abusing-gdi-for-ring0-exploit-primitives) - by Diego Juarez [2015]
+ [Duqu 2.0 Win32k exploit analysis](https://www.virusbulletin.com/uploads/pdf/conference_slides/2015/OhFlorio-VB2015.pdf) - [2015]

### <a name="windows_memory_protections" />Windows memory protections
+ [Data Execution Prevention](http://support.microsoft.com/kb/875352)
+ [/GS (Buffer Security Check)](http://msdn.microsoft.com/en-us/library/Aa290051)
+ [/SAFESEH](http://msdn.microsoft.com/en-us/library/9a89h429(VS.80).aspx)
+ [ASLR](http://blogs.msdn.com/michael_howard/archive/2006/05/26/address-space-layout-randomization-in-windows-vista.aspx)
+ [SEHOP](http://blogs.technet.com/srd/archive/2009/02/02/preventing-the-exploitation-of-seh-overwrites-with-sehop.aspx)

### <a name="windows_shellcoding" />Windows shellcoding
+ [Corelan – Introduction to Win32 shellcoding](https://www.corelan.be/index.php/2010/02/25/exploit-writing-tutorial-part-9-introduction-to-win32-shellcoding/)


## <a name="linux_exploit_development" />Linux Exploit Development

### <a name="format_strings" />Format Strings
+ [Linux Format String Exploitation](http://www.fuzzysecurity.com/tutorials/expDev/10.html)
+ [Infosec Institute – Format String Bug Exploration](http://resources.infosecinstitute.com/format-string-bug-exploration/)
+ [Automating format string exploits](https://github.com/PrateekJain90/ExploitingFormatStringVulnerabilities?platform=hootsuite)

### <a name="ret2libc" />Ret2libc
+ [Linux exploit development part 3 - ret2libc by Sickness](https://www.exploit-db.com/docs/17131.pdf)


## <a name="reverse_engineering" />Reverse Engineering
+ [tuts4you – Reversing for Newbies](https://tuts4you.com/download.php?list.17)

## <a name="fuzzing" />Fuzzing
+ [Infosec Institute – Intro to fuzzing](http://resources.infosecinstitute.com/intro-to-fuzzing/)
+ [Infosec Institute – Fuzzer automation with spike](http://resources.infosecinstitute.com/fuzzer-automation-with-spike/)
+ [Infosec Institute – Sulley Fuzzing Framework Intro](http://www.proxysec.io/the-ultimate-beginner-exploit-developers-resource-guide/resources.infosecinstitute.com/sulley-fuzzing/)
+ [Infosec Institute – Fuzzing Vulnserver: Discovering Vulnerable Commands: Part 1](http://resources.infosecinstitute.com/fuzzing-vulnserver-discovering-vulnerable-commands-part-1/)
+ [Infosec Institute – Fuzzing Vulnserver with Peach: Part 2](http://resources.infosecinstitute.com/fuzzing-vulnserver-with-peach-part-2/)
+ [Infosec Institute – Fuzzing Vulnserver with Sulley: Part 3](http://resources.infosecinstitute.com/fuzzing-vulnserver-with-sulley-part-3/)
+ [Peachfuzzer – Tutorial](http://community.peachfuzzer.com/v3/TutorialFileFuzzing.html)
+ [evilsocket.net – Fuzzing with AFL-Fuzz, a Practical Example](https://www.evilsocket.net/2015/04/30/fuzzing-with-afl-fuzz-a-practical-example-afl-vs-binutils/)
+ [Infosec Institute – Fuzzing – Mutation vs. Generation](http://resources.infosecinstitute.com/fuzzing-mutation-vs-generation/)
+ [FoxgloveSecurity – Fuzzing workflows; a fuzz job from start to finish](https://foxglovesecurity.com/2016/03/15/fuzzing-workflows-a-fuzz-job-from-start-to-finish/)

## <a name="binary_exploitation_challenges" />Binary Exploitation Challenges:
+ [exploit-exercises.com/protostar](https://exploit-exercises.com/protostar)
+ [exploit-exercises.com/fusion](https://exploit-exercises.com/fusion)
+ [smashthestack.org/](http://smashthestack.org/)
+ [www.vulnhub.com/entry/smashthetux-1,138](https://www.vulnhub.com/entry/smashthetux-1,138/)
+ [github.com/kablaa/CTF-Workshop](https://github.com/kablaa/CTF-Workshop)
+ [overthewire.org/wargames/narnia/](http://overthewire.org/wargames/narnia/)
+ [overthewire.org/wargames/behemoth/](http://overthewire.org/wargames/behemoth/)
+ [www.thegreycorner.com/p/vulnserver.html](http://www.thegreycorner.com/p/vulnserver.html)
